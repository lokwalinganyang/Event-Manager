{% extends 'base.html' %}

{% block title %}API Documentation - EventFlow{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <div class="card">
                <div class="card-header">
                    <h1 class="h3 mb-0 text-white">
                        <i class="fas fa-code me-2"></i>EventFlow API Documentation
                    </h1>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        All API endpoints return JSON responses and require <code>Content-Type: application/json</code> header for POST requests.
                    </div>

                    <h4 class="gradient-text mt-4">Base URL</h4>
                    <div class="card bg-light">
                        <div class="card-body">
                            <code>https://{{ request.get_host }}/api/</code>
                        </div>
                    </div>

                    <h4 class="gradient-text mt-5">Endpoints</h4>

                    <!-- Events List Endpoint -->
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                            <strong>GET /events/</strong>
                            <span class="badge bg-light text-success">PUBLIC</span>
                        </div>
                        <div class="card-body">
                            <p>Retrieve a list of all upcoming events.</p>
                            
                            <h6>Example Request:</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>GET /api/events/</code></pre>

                            <h6>Example Response:</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>[
  {
    "id": 1,
    "title": "THE BLACK GOLD COLOURFEST",
    "description": "An amazing festival...",
    "date": "2024-12-01T18:00:00Z",
    "location": "Central Park, New York",
    "max_participants": 1000,
    "registered_count": 150,
    "is_full": false
  }
]</code></pre>

                            <a href="{% url 'events:api_events' %}" class="btn btn-success mt-2" target="_blank">
                                <i class="fas fa-external-link-alt me-1"></i>Test Endpoint
                            </a>
                        </div>
                    </div>

                    <!-- Event Detail Endpoint -->
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                            <strong>GET /events/{id}/</strong>
                            <span class="badge bg-light text-success">PUBLIC</span>
                        </div>
                        <div class="card-body">
                            <p>Retrieve detailed information about a specific event.</p>
                            
                            <h6>Example Request:</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>GET /api/events/1/</code></pre>

                            <h6>Example Response:</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>{
  "id": 1,
  "title": "THE BLACK GOLD COLOURFEST",
  "description": "An amazing festival...",
  "date": "2024-12-01T18:00:00Z",
  "location": "Central Park, New York",
  "max_participants": 1000,
  "registered_count": 150,
  "is_full": false,
  "registrations": [
    {
      "id": 1,
      "first_name": "John",
      "last_name": "Doe",
      "email": "john@example.com",
      "phone": "+1234567890",
      "registered_at": "2024-01-15T10:30:00Z"
    }
  ]
}</code></pre>
                        </div>
                    </div>

                    <!-- Register Endpoint -->
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <strong>POST /register/</strong>
                            <span class="badge bg-light text-primary">PUBLIC</span>
                        </div>
                        <div class="card-body">
                            <p>Register a participant for an event.</p>
                            
                            <h6>Request Format:</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>POST /api/register/
Content-Type: application/json

{
  "first_name": "string (required)",
  "last_name": "string (required)", 
  "email": "string (required)",
  "phone": "string (optional)",
  "event": "integer (required - event ID)"
}</code></pre>

                            <h6>Example Request:</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>{
  "first_name": "John",
  "last_name": "Doe",
  "email": "john@example.com",
  "phone": "+1234567890",
  "event": 1
}</code></pre>

                            <h6>Success Response (201):</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>{
  "message": "Registration successful!",
  "data": {
    "id": 1,
    "first_name": "John",
    "last_name": "Doe",
    "email": "john@example.com",
    "phone": "+1234567890",
    "event": 1
  }
}</code></pre>

                            <h6>Error Response (400):</h6>
                            <pre class="bg-dark text-light p-3 rounded"><code>{
  "error": "This event is already full."
}</code></pre>

                            <div class="mt-3">
                                <h6>Test with curl:</h6>
                                <pre class="bg-dark text-light p-3 rounded"><code>curl -X POST {{ request.scheme }}://{{ request.get_host }}/api/register/ \
  -H "Content-Type: application/json" \
  -d '{
    "first_name": "John",
    "last_name": "Doe",
    "email": "john@example.com", 
    "phone": "+1234567890",
    "event": 1
  }'</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <a href="{% url 'events:home' %}" class="btn btn-primary">
                            <i class="fas fa-arrow-left me-1"></i>Back to Events
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}